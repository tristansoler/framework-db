{
    "data_framework": {
      "core_version": "last"
    },
    "dataflows": {
        "default": {
            "processes": {
              "landing_to_raw": {
                "incoming_file": {
                  "zipped": "",
                  "file_format": "csv",
                  "filename_pattern": "^LUX_RETURNS_JP_MORGAN_(\\d{4})_(\\d{2})_(\\d{2})$",
                  "csv_specs": {
                    "header_position": 0,
                    "header": true,
                    "encoding": "UTF-8",
                    "delimiter": ",",
                    "date_located": "filename",
                    "date_located_filename": {
                      "regex": "(\\d{4})_(\\d{2})_(\\d{2})"
                    }
                  },
                  "validations": {
                    "validate_extension": true,
                    "validate_filename": true,
                    "validate_csv": true,
                    "validate_columns": true
                  }
                },
                "output_file": {
                  "database": "funds_raw",
                  "table": "luxembourg_portfolio_returns",
                  "partition_field": "data_date"
                },
                "processing_specifications": {
                  "technology": "lambda",
                  "hardware": {
                    "ram": 512
                  }
                }
              },
              "raw_to_staging": {
                "incoming_file": {
                  "database": "funds_raw",
                  "table": "luxembourg_portfolio_returns",
                  "partition_field": "data_date"
                },
                "output_file": {
                  "database": "funds_staging",
                  "table": "luxembourg_portfolio_returns"
                },
                "output_file_2": {
                  "database": "funds_staging",
                  "table": "portfolio_returns",
                  "primary_keys": [
                    "country",
                    "account_number",
                    "base_currency",
                    "position_date",
                    "security_number_full",
                    "trading_currency"
                  ]
                },
                "processing_specifications": {
                  "technology": "emr",
                  "hardware": {
                    "ram": 512
                  },
                  "spark_configuration": {
                    "catalog": "iceberg_catalog",
                    "warehouse": "funds_staging",
                    "custom_configuration": [
                      {
                        "parameter": "",
                        "value": ""
                      }
                    ]
                  }
                }
              },
              "to_output": {
                "output_reports": [{
                  "name" : "funds_staging",
                  "table": "morningstar_dividends",
                  "columns": ["secid", "performanceid", "currencyiso"],
                  "columns_alias": ["id", "performance_id", "currency_ISO"],
                  "where": "1=1",
                  "file_format": "csv",
                  "filename_pattern": "fichero_output_{}",
                  "csv_specs": {
                    "header": true,
                    "encoding": "UTF-8",
                    "delimiter": ","
                  }
                }],
                "processing_specifications": {
                  "technology": "lambda",
                  "hardware": {
                  "ram": 512
                  },
                  "spark_configuration": {
                    "default_catalog": true,
                    "warehouse": "funds_raw",
                    "custom_configuration": [
                      {
                        "parameter": "",
                        "value": ""
                      }
                    ]
                  }
                }
              }
            }
        }
    }
}